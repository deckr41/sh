#!/usr/bin/env sh

# NAME
#  sh41-utils
#
# SYNOPSIS
#
# DESCRIPTION
#
# ERRORS
#  1 - Argument/flag parsing error
#  2 - File/command not found
#  3 - Dependent environment variable not set

if [ -z "$SH41_UTILS" ]; then
  echo "SH41_UTILS environment variable is not set" >&2
  exit 3
fi

# Redirect stdin from /dev/tty to ensure it's treated as interactive
# and not inherited from parent's stdin
log_error() { "$SH41_UTILS"/log "$@" "sh41-utils" < /dev/tty; }

# ╭───┤ Argument parsing
# ╰─

name="$1"; shift

# ╭───┤ Input validation 
# ╰─

if [ -z "$name" ]; then
  log_error "no command provided"
  exit 1
fi

if [ ! -f "$SH41_UTILS/$name" ]; then
  log_error "command \"$name\" does not exist"
  exit 2
fi

# ╭───┤ Main
# ╰─

"$SH41_UTILS"/"$name" "$@" < /dev/stdin
