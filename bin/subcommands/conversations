#!/usr/bin/env sh

# NAME
#  conversations - Entry point for all things Conversations
#
# SYNOPSIS
#  conversations build [...args]
#  conversations append [...args]
#  conversations validate [...args]
#
# ENVIRONMENT
#  SH41_LIB
#   Path to SH41 internal lib directory.
#
#  SH41_ICON
#   SH41 logo icon

# ╭───┤ Bootstrap
# ╰─

# Exit on first error
set -e

# log config
export LOG_NAMESPACE="$SH41_ICON conversations"

# ╭───┤ Main 
# ╰─

export SH41_LIB_CONVERSATIONS="$SH41_LIB/conversations"

subcommand="$1";
if [ -z "$subcommand" ]; then
  log error "No command provided"
  exit 1
fi
shift

case $subcommand in
  build) exec "$SH41_LIB_CONVERSATIONS"/build "$@" < /dev/stdin ;;
  append) exec "$SH41_LIB_CONVERSATIONS"/append "$@" < /dev/stdin ;;
  validate) exec "$SH41_LIB_CONVERSATIONS"/validate "$@" < /dev/stdin ;;
  *) log error -v cmd "$subcommand" "Unknown command"; exit 1 ;;
esac
